<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simple DOCX Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
        }
        button {
            background: #4caf50;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 6px;
            cursor: pointer;
            margin: 10px;
            font-size: 16px;
        }
        button:hover {
            background: #45a049;
        }
        .result {
            margin: 20px 0;
            padding: 15px;
            border-radius: 6px;
            font-weight: bold;
        }
        .success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
    </style>
    <script src="https://unpkg.com/docx@8.5.0/build/index.js"></script>
    <script src="https://unpkg.com/file-saver@2.0.5/dist/FileSaver.min.js"></script>
</head>
<body>
    <h1>🧪 Simple DOCX Generation Test</h1>
    <p>This test creates a very simple DOCX document to verify the fix works.</p>
    
    <button onclick="testSimpleDocx()">Generate Simple DOCX</button>
    <div id="result"></div>

    <script>
        async function testSimpleDocx() {
            const resultDiv = document.getElementById('result');
            
            try {
                resultDiv.innerHTML = 'Generating simple DOCX document...';
                
                // Create a very simple document
                const doc = new docx.Document({
                    sections: [{
                        properties: {
                            page: {
                                size: {
                                    orientation: "portrait",
                                    width: 595,
                                    height: 842,
                                },
                                margin: {
                                    top: 720,
                                    right: 720,
                                    bottom: 720,
                                    left: 720,
                                },
                            },
                        },
                        children: [
                            // Title
                            new docx.Paragraph({
                                children: [
                                    new docx.TextRun({
                                        text: "NFA Output",
                                        bold: true,
                                        size: 32,
                                        font: "Arial",
                                    }),
                                ],
                                alignment: docx.AlignmentType.CENTER,
                                spacing: {
                                    after: 400,
                                },
                            }),
                            
                            // Date
                            new docx.Paragraph({
                                children: [
                                    new docx.TextRun({
                                        text: `Date: ${new Date().toLocaleDateString('en-GB')}`,
                                        size: 24,
                                        font: "Arial",
                                    }),
                                ],
                                alignment: docx.AlignmentType.RIGHT,
                                spacing: {
                                    after: 400,
                                },
                            }),
                            
                            // Simple content
                            new docx.Paragraph({
                                children: [
                                    new docx.TextRun({
                                        text: "Subject: Test NFA Document",
                                        bold: true,
                                        size: 24,
                                        font: "Arial",
                                    }),
                                ],
                                alignment: docx.AlignmentType.JUSTIFY,
                                spacing: { after: 200 },
                            }),
                            
                            new docx.Paragraph({
                                children: [
                                    new docx.TextRun({
                                        text: "This is a test NFA document to verify that the DOCX generation is working correctly.",
                                        size: 24,
                                        font: "Arial",
                                    }),
                                ],
                                alignment: docx.AlignmentType.JUSTIFY,
                                spacing: { after: 200 },
                            }),
                            
                            new docx.Paragraph({
                                children: [
                                    new docx.TextRun({
                                        text: "• This is a bullet point",
                                        size: 24,
                                        font: "Arial",
                                    }),
                                ],
                                alignment: docx.AlignmentType.JUSTIFY,
                                spacing: { after: 200 },
                            }),
                            
                            new docx.Paragraph({
                                children: [
                                    new docx.TextRun({
                                        text: "• This is another bullet point",
                                        size: 24,
                                        font: "Arial",
                                    }),
                                ],
                                alignment: docx.AlignmentType.JUSTIFY,
                                spacing: { after: 400 },
                            }),
                            
                            // Conclusion
                            new docx.Paragraph({
                                children: [
                                    new docx.TextRun({
                                        text: "The above proposal is submitted for approval, and the amount may kindly be reimbursed to the organizing committee after the event upon submission of the online report, receipts, and GST bills.",
                                        size: 24,
                                        font: "Arial",
                                    }),
                                ],
                                alignment: docx.AlignmentType.JUSTIFY,
                                spacing: {
                                    before: 400,
                                    after: 400,
                                },
                            }),
                            
                            // Simple signature
                            new docx.Paragraph({
                                children: [
                                    new docx.TextRun({
                                        text: "_________________",
                                        size: 20,
                                        font: "Arial",
                                    }),
                                ],
                                alignment: docx.AlignmentType.JUSTIFY,
                                spacing: { after: 100 },
                            }),
                            
                            new docx.Paragraph({
                                children: [
                                    new docx.TextRun({
                                        text: "Dr Test User",
                                        size: 20,
                                        font: "Arial",
                                    }),
                                ],
                                alignment: docx.AlignmentType.JUSTIFY,
                                spacing: { after: 100 },
                            }),
                            
                            new docx.Paragraph({
                                children: [
                                    new docx.TextRun({
                                        text: "Test Designation",
                                        size: 20,
                                        font: "Arial",
                                    }),
                                ],
                                alignment: docx.AlignmentType.JUSTIFY,
                                spacing: { after: 100 },
                            }),
                            
                            new docx.Paragraph({
                                children: [
                                    new docx.TextRun({
                                        text: "(Test Signature)",
                                        size: 20,
                                        font: "Arial",
                                    }),
                                ],
                                alignment: docx.AlignmentType.JUSTIFY,
                                spacing: { after: 200 },
                            }),
                        ],
                    }],
                });
                
                // Generate and download the document
                const blob = await docx.Packer.toBlob(doc);
                const fileName = `simple_test_${new Date().toISOString().slice(0, 10)}.docx`;
                
                saveAs(blob, fileName);
                
                resultDiv.innerHTML = '<div class="result success">✅ Simple DOCX document generated and downloaded successfully!</div>';
                
            } catch (error) {
                console.error('Error generating DOCX:', error);
                resultDiv.innerHTML = `<div class="result error">❌ Error generating DOCX: ${error.message}</div>`;
            }
        }

        // Auto-test on page load
        window.onload = function() {
            console.log('🧪 Simple DOCX Test Page Loaded');
            console.log('Click "Generate Simple DOCX" to test');
        };
    </script>
</body>
</html>

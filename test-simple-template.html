<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simple Template Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
        }
        button {
            background: #4caf50;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 6px;
            cursor: pointer;
            margin: 10px;
            font-size: 16px;
        }
        button:hover {
            background: #45a049;
        }
        .result {
            margin: 20px 0;
            padding: 15px;
            border-radius: 6px;
            font-weight: bold;
        }
        .success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
    </style>
    <script src="https://unpkg.com/docx@8.5.0/build/index.js"></script>
    <script src="https://unpkg.com/file-saver@2.0.5/dist/FileSaver.min.js"></script>
</head>
<body>
    <h1>🧪 Simple Template Test</h1>
    <p>This test creates a DOCX document matching your exact template structure.</p>
    
    <button onclick="testTemplateDocx()">Generate Template DOCX</button>
    <div id="result"></div>

    <script>
        async function testTemplateDocx() {
            const resultDiv = document.getElementById('result');
            
            try {
                resultDiv.innerHTML = 'Generating template DOCX document...';
                
                // Create document with exact template structure
                const doc = new docx.Document({
                    sections: [{
                        properties: {
                            page: {
                                size: {
                                    orientation: "portrait",
                                    width: 595,
                                    height: 842,
                                },
                                margin: {
                                    top: 720,
                                    right: 720,
                                    bottom: 720,
                                    left: 720,
                                },
                            },
                        },
                        children: [
                            // RV University Header Section
                            new docx.Paragraph({
                                children: [
                                    new docx.TextRun({
                                        text: "RV UNIVERSITY",
                                        bold: true,
                                        size: 24,
                                        font: "Arial",
                                    }),
                                ],
                                alignment: docx.AlignmentType.CENTER,
                                spacing: { after: 100 },
                            }),
                            
                            new docx.Paragraph({
                                children: [
                                    new docx.TextRun({
                                        text: "Go, change the world",
                                        size: 18,
                                        font: "Arial",
                                    }),
                                ],
                                alignment: docx.AlignmentType.CENTER,
                                spacing: { after: 100 },
                            }),
                            
                            new docx.Paragraph({
                                children: [
                                    new docx.TextRun({
                                        text: "An initiative of RV Educational Institutions",
                                        size: 16,
                                        font: "Arial",
                                    }),
                                ],
                                alignment: docx.AlignmentType.CENTER,
                                spacing: { after: 200 },
                            }),
                            
                            // Contact Information
                            new docx.Paragraph({
                                children: [
                                    new docx.TextRun({
                                        text: "RV Vidyaniketan, 8th Mile, Mysuru Road, Bengaluru, 560059 India",
                                        size: 16,
                                        font: "Arial",
                                    }),
                                ],
                                alignment: docx.AlignmentType.CENTER,
                                spacing: { after: 100 },
                            }),
                            
                            new docx.Paragraph({
                                children: [
                                    new docx.TextRun({
                                        text: "+91 80 68199900",
                                        size: 16,
                                        font: "Arial",
                                    }),
                                ],
                                alignment: docx.AlignmentType.CENTER,
                                spacing: { after: 100 },
                            }),
                            
                            new docx.Paragraph({
                                children: [
                                    new docx.TextRun({
                                        text: "www.rvu.edu.in",
                                        size: 16,
                                        font: "Arial",
                                    }),
                                ],
                                alignment: docx.AlignmentType.CENTER,
                                spacing: { after: 300 },
                            }),
                            
                            // Date
                            new docx.Paragraph({
                                children: [
                                    new docx.TextRun({
                                        text: `Date: ${new Date().toLocaleDateString('en-GB')}`,
                                        size: 20,
                                        font: "Arial",
                                    }),
                                ],
                                alignment: docx.AlignmentType.RIGHT,
                                spacing: { after: 300 },
                            }),
                            
                            // NFA Title
                            new docx.Paragraph({
                                children: [
                                    new docx.TextRun({
                                        text: "Note For Approval (NFA)",
                                        bold: true,
                                        size: 22,
                                        font: "Arial",
                                    }),
                                ],
                                alignment: docx.AlignmentType.CENTER,
                                spacing: { after: 300 },
                            }),
                            
                            // Subject
                            new docx.Paragraph({
                                children: [
                                    new docx.TextRun({
                                        text: "Subject: ",
                                        bold: true,
                                        size: 20,
                                        font: "Arial",
                                    }),
                                    new docx.TextRun({
                                        text: "inauguration of chess by panchatantra",
                                        size: 20,
                                        font: "Arial",
                                    }),
                                ],
                                alignment: docx.AlignmentType.JUSTIFY,
                                spacing: { after: 200 },
                            }),
                            
                            // Request paragraph
                            new docx.Paragraph({
                                children: [
                                    new docx.TextRun({
                                        text: "Request for approval regarding the inauguration of chess by Panchatantra on 16th August at 10 AM. This event will be held in collaboration with RV University and Bharatiya Vidya Bhavan. The objective is to promote strategic thinking and cultural exchange through chess.",
                                        size: 20,
                                        font: "Arial",
                                    }),
                                ],
                                alignment: docx.AlignmentType.JUSTIFY,
                                spacing: { after: 200 },
                            }),
                            
                            // Bullet points
                            new docx.Paragraph({
                                children: [
                                    new docx.TextRun({
                                        text: "• The inauguration will feature AVS Murthy, Chancellor of RV University, as the chief guest.",
                                        size: 20,
                                        font: "Arial",
                                    }),
                                ],
                                alignment: docx.AlignmentType.JUSTIFY,
                                spacing: { after: 200 },
                            }),
                            
                            new docx.Paragraph({
                                children: [
                                    new docx.TextRun({
                                        text: "• The event aims to foster educational partnerships between institutions and enhance community engagement.",
                                        size: 20,
                                        font: "Arial",
                                    }),
                                ],
                                alignment: docx.AlignmentType.JUSTIFY,
                                spacing: { after: 300 },
                            }),
                            
                            // Table
                            new docx.Paragraph({
                                children: [
                                    new docx.TextRun({
                                        text: "Financial/Resource Implications Table:",
                                        bold: true,
                                        size: 20,
                                        font: "Arial",
                                    }),
                                ],
                                spacing: {
                                    before: 300,
                                    after: 200,
                                },
                            }),
                            
                            // Simple table as text
                            new docx.Paragraph({
                                children: [
                                    new docx.TextRun({
                                        text: "slno | item | unit | total",
                                        bold: true,
                                        size: 18,
                                        font: "Arial",
                                    }),
                                ],
                                alignment: docx.AlignmentType.CENTER,
                                spacing: { after: 100 },
                            }),
                            
                            new docx.Paragraph({
                                children: [
                                    new docx.TextRun({
                                        text: "-------- | -------- | -------- | --------",
                                        size: 18,
                                        font: "Arial",
                                    }),
                                ],
                                alignment: docx.AlignmentType.CENTER,
                                spacing: { after: 100 },
                            }),
                            
                            new docx.Paragraph({
                                children: [
                                    new docx.TextRun({
                                        text: "1 | prize | 2 | 20",
                                        size: 18,
                                        font: "Arial",
                                    }),
                                ],
                                alignment: docx.AlignmentType.CENTER,
                                spacing: { after: 100 },
                            }),
                            
                            new docx.Paragraph({
                                children: [
                                    new docx.TextRun({
                                        text: "1 | prize | 2 | 20",
                                        size: 18,
                                        font: "Arial",
                                    }),
                                ],
                                alignment: docx.AlignmentType.CENTER,
                                spacing: { after: 100 },
                            }),
                            
                            new docx.Paragraph({
                                children: [
                                    new docx.TextRun({
                                        text: "1 | prize | 2 | 20",
                                        size: 18,
                                        font: "Arial",
                                    }),
                                ],
                                alignment: docx.AlignmentType.CENTER,
                                spacing: { after: 100 },
                            }),
                            
                            new docx.Paragraph({
                                children: [
                                    new docx.TextRun({
                                        text: " | | | 60",
                                        size: 18,
                                        font: "Arial",
                                    }),
                                ],
                                alignment: docx.AlignmentType.CENTER,
                                spacing: { after: 300 },
                            }),
                            
                            // Conclusion
                            new docx.Paragraph({
                                children: [
                                    new docx.TextRun({
                                        text: "The above proposal is submitted for approval, and the advance amount may kindly be released to the organizing committee to conduct the event smoothly.",
                                        size: 20,
                                        font: "Arial",
                                    }),
                                ],
                                alignment: docx.AlignmentType.JUSTIFY,
                                spacing: {
                                    before: 300,
                                    after: 300,
                                },
                            }),
                            
                            // Simple signatures
                            new docx.Paragraph({
                                children: [
                                    new docx.TextRun({
                                        text: "_________________",
                                        size: 18,
                                        font: "Arial",
                                    }),
                                ],
                                alignment: docx.AlignmentType.JUSTIFY,
                                spacing: { after: 100 },
                            }),
                            
                            new docx.Paragraph({
                                children: [
                                    new docx.TextRun({
                                        text: "Dr Phani Kumar Pullela",
                                        size: 18,
                                        font: "Arial",
                                    }),
                                ],
                                alignment: docx.AlignmentType.JUSTIFY,
                                spacing: { after: 100 },
                            }),
                            
                            new docx.Paragraph({
                                children: [
                                    new docx.TextRun({
                                        text: "Dean, Student Affairs",
                                        size: 18,
                                        font: "Arial",
                                    }),
                                ],
                                alignment: docx.AlignmentType.JUSTIFY,
                                spacing: { after: 100 },
                            }),
                            
                            new docx.Paragraph({
                                children: [
                                    new docx.TextRun({
                                        text: "(Prepared by)",
                                        size: 18,
                                        font: "Arial",
                                    }),
                                ],
                                alignment: docx.AlignmentType.JUSTIFY,
                                spacing: { after: 200 },
                            }),
                        ],
                    }],
                });
                
                // Generate and download the document
                const blob = await docx.Packer.toBlob(doc);
                const fileName = `template_test_${new Date().toISOString().slice(0, 10)}.docx`;
                
                saveAs(blob, fileName);
                
                resultDiv.innerHTML = '<div class="result success">✅ Template DOCX document generated and downloaded successfully!</div>';
                
            } catch (error) {
                console.error('Error generating DOCX:', error);
                resultDiv.innerHTML = `<div class="result error">❌ Error generating DOCX: ${error.message}</div>`;
            }
        }

        // Auto-test on page load
        window.onload = function() {
            console.log('🧪 Simple Template Test Page Loaded');
            console.log('Click "Generate Template DOCX" to test');
        };
    </script>
</body>
</html>
